from dataclasses import dataclass, field
from typing import List, Optional

from dataclasses_json import dataclass_json, LetterCase

from phonepe.sdk.pg.common.models.request.payment_mode_constraints.payment_mode_constraint import PaymentModeConstraint
from phonepe.sdk.pg.common.models.request.payment_mode_constraints.payment_mode_mapper import (
    map_to_payment_mode,
)


@dataclass_json(letter_case=LetterCase.CAMEL)
@dataclass
class PaymentModeConfig:
    enabled_payment_modes: Optional[List[PaymentModeConstraint]] = field(default=None)
    disabled_payment_modes: Optional[List[PaymentModeConstraint]] = field(default=None)

    def __post_init__(self):
        if self.enabled_payment_modes:
            self.enabled_payment_modes = [
                map_to_payment_mode(mode) for mode in self.enabled_payment_modes
            ]

        if self.disabled_payment_modes:
            self.disabled_payment_modes = [
                map_to_payment_mode(mode) for mode in self.disabled_payment_modes
            ]
